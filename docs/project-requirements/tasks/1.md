# Task 1: Design and implement database schema for quotes, negotiations, messages, and decisions

**Dependencies:** None

### Goal
Establish the Convex database schema to support the AI negotiation system with proper relationships and data integrity.

### Implementation Context
**Files to Modify:**
- `src/server/schema.ts`

**Key Requirements:**
- Quote Request table with products array, user notes, decision priorities, and status tracking
- Negotiation table linking quotes to suppliers with status tracking
- Message table for conversation history with sender identification
- Decision table for final supplier selection with evaluation scores
- Products loaded from static JSON file (not in database)

**Technical Notes:**
- Follow existing schema pattern using `defineTable` and `v` validators from Convex
- Use indexes for frequently queried fields (quote_id, negotiation_id)
- Status fields use string enums for type safety
- Timestamps use `v.number()` for Unix timestamps
- Arrays use `v.array()` with nested object validators

### Scope Definition
**Deliverables:**
- Quote Request table: quote_id, user_id, products (array), user_notes, decision_priorities (object), status, created_at, completed_at
- Negotiation table: negotiation_id, quote_id, supplier_id, status, created_at, completed_at
- Message table: message_id, negotiation_id, sender, content, timestamp, metadata (object)
- Decision table: decision_id, quote_id, selected_supplier_id, reasoning, evaluation_scores (object), created_at
- Indexes on quote_id and negotiation_id for efficient lookups

**Exclusions:**
- Products table (loaded from static JSON)
- User authentication schema (out of scope)

### Implementation Steps
1. Add Quote Request table with fields: products array (product_id, quantity), user_notes (optional), decision_priorities object (quality, cost, lead_time, payment_terms), status enum
2. Add Negotiation table with quote_id reference, supplier_id (1-3), status enum (active, completed, impasse)
3. Add Message table with negotiation_id reference, sender enum (brand, supplier, user), content string, timestamp, optional metadata object
4. Add Decision table with quote_id reference, selected_supplier_id, reasoning string, evaluation_scores object
5. Create indexes: `by_quote_id` on Negotiation table, `by_negotiation_id` on Message table, `by_quote_id` on Decision table

### Success Criteria
- All four tables defined with proper field types and validators
- Indexes created for efficient relationship queries
- Schema validates successfully with Convex CLI
- Status enums properly constrained to valid values
- Optional fields marked with `v.optional()`

### Scope Constraint
Implement only the database schema definition. Do not create queries, mutations, or actions yet.